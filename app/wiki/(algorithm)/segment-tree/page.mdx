import { CodeSelector } from '@/components/code-selector.tsx'

# 세그먼트 트리

`세그먼트 트리`는 구간 질의를 처리하는 것과 배열의 원소를 갱신하는 것을 $O(\log n)$ 시간에 처리해주는 자료구조다.

구현 방법으로 상향식(bottom-up)과 하향식(top-down)이 있는데, 상향식 방법이 더 빠르고 이해하기가 쉽다.

세그먼트 트리는 이진 트리의 일종으로 내부 노드와 리프노드로 구분된다.

리프 노드는 원래 배열의 원소가 들어있으며, 내부 노드는 연산을 처리하기 위한 값들이 들어있다.

세그먼트 트리에 제공하는 배열은 크기가 2의 거듭제곱이라고 가정한다.

2의 거듭제곱이 아니라면 임의로 크기를 늘리고 0을 채워 넣는다.

<CodeSelector names={['js']} desc='ex1' />

```js
// 2의 거듭제곱으로 만드는 방법
Math.ceil(Math.log2(n))
```

트리의 노드의 개수는 배열의 크기의 2배 + 1을 사용한다.

즉, 1번 부터 n번 노드까지는 내부 노드가 되고 n + 1번 부터 2n번 노드까지는 리프노드가 된다.

세그먼트 트리의 원리는 임의의 구간 $[a, b]$를 부분 구간 $O(\log n)$개로 나누고 그에 해당하는 구간의 연산을 미리 저장해두는 것이다.

따라서 쿼리마다 필요한 노드의 전체 개수는 $O(\log n)$개가 된다.

## References

- [세그먼트 트리 구현 코드(js)](https://github.com/wonkyum-kim/BOJS/blob/main/lib/segment-tree.js)
