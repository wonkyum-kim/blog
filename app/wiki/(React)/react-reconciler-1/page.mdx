# ğŸ“ ì‘ì„± ì¤‘...

## ReactFiber.js

`ReactFiber.js`ì—ëŠ” Fiber ê°ì²´ë¥¼ ì •ì˜í•˜ê³  ìƒì„±í•˜ëŠ” ì½”ë“œê°€ ë“¤ì–´ìˆë‹¤.

### createFiber

`Fiber` ê°ì²´ë¥¼ ìƒì„±í•˜ì—¬ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜. Fiber ê°ì²´ë¥¼ ë§Œë“œëŠ” ëª¨ë“  í•¨ìˆ˜ëŠ” ì´ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê²Œ ëœë‹¤.

FiberëŠ” ì•„ë˜ì™€ ê°™ì€ í•„ë“œë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤.

| key           | value                                                                                        |
| ------------- | -------------------------------------------------------------------------------------------- |
| tag           | Fiberì˜ íƒ€ì…ì„ ì‹ë³„í•˜ëŠ” íƒœê·¸. ReactWorkTag.jsì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.                            |
| key           | ReactElement.keyì™€ ê°™ë‹¤.                                                                     |
| elementType   | ReactElement.typeê³¼ ê°™ë‹¤.                                                                    |
| type          | i.e. ReactElement.type, ê·¸ ì™¸ì— ì—¬ëŸ¬ ê°’ì´ ë” ê°€ëŠ¥                                            |
| stateNode     | ì´ Fiberì™€ ì—°ê´€ë˜ì–´ ìˆëŠ” local state                                                         |
| return        | ë¶€ëª¨ Fiber ê°ì²´                                                                              |
| child         | ì²« ë²ˆì§¸ ìì‹ Fiber ê°ì²´. ìì‹ì´ ì—¬ëŸ¬ ê°œì´ë©´, indexë¡œ êµ¬ë¶„í•  ìˆ˜ ìˆë‹¤.                         |
| sibling       | ë‹¤ìŒ í˜•ì œ Fiber ê°ì²´.                                                                        |
| index         | ì—¬ëŸ¬ í˜•ì œë“¤ ì‚¬ì´ì—ì„œ ìì‹ ì´ ëª‡ ë²ˆì§¸ ìì‹ì¸ì§€ ë‚˜íƒ€ë‚¸ë‹¤.                                       |
| ref           |                                                                                              |
| refCleanup    |                                                                                              |
| pendingProps  | ReactElement.propsì™€ ê°™ë‹¤.                                                                   |
| memoizedProps | ë Œë”ë§ì´ ì™„ë£Œëœ í›„ pendingPropsë¥¼ ì €ì¥í•œë‹¤.                                                  |
| updateQueue   | ìƒíƒœ ì—…ë°ì´íŠ¸ì™€ ì½œë°± í•¨ìˆ˜ë“¤ì„ ì €ì¥í•˜ëŠ” í                                                    |
| memoizedState | í˜„ì¬ Fiberì˜ í›…ì´ ë§í¬ë“œ ë¦¬ìŠ¤íŠ¸ í˜•íƒœë¡œ ì €ì¥ë˜ì–´ ìˆë‹¤.                                        |
| dependencies  | ì´ Fiberì˜ ë””íœë˜ì‹œ(contexts, events)                                                        |
| mode          | Fiberì™€ ê·¸ ì„œë¸ŒíŠ¸ë¦¬ì˜ í”„ë¡œí¼í‹°ë“¤ì„ ì„¤ëª…í•˜ëŠ” ë¹„íŠ¸í•„ë“œ. ReactTypeofMode.jsì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤. |
| flags         | ì—…ë°ì´íŠ¸, í´ë¡  ë“± ë‹¤ì–‘í•œ ìƒí™©ì— ëŒ€í•œ í”Œë˜ê·¸. ReactFiberFlags.jsì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.          |
| subtreeFlags  |                                                                                              |
| deletions     | ì‚­ì œëœ Fiber ë°°ì—´                                                                            |
| lanes         | ì‘ì—…ì˜ ìš°ì„ ìˆœìœ„ë¥¼ ê´€ë¦¬í•œë‹¤. ReactFiberLane.jsì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.                            |
| childLanes    |                                                                                              |
| alternate     | ë°˜ëŒ€í¸ Fiber íŠ¸ë¦¬(current/workInProgress)ë¥¼ ê°€ë¦¬í‚¨ë‹¤.                                        |

### isFunctionClassComponent

TODO: ì–´ë””ì„œ í˜¸ì¶œë˜ëŠ”ê°€?

### createWorkInProgress

TODO: ì–´ë””ì„œ í˜¸ì¶œë˜ëŠ”ê°€?

ì‘ì—…ì„ ì§„í–‰í•  ë°˜ëŒ€í¸ íŒŒì´ë²„(`workInProgress`)ë¥¼ ë§Œë“œëŠ” í•¨ìˆ˜ë‹¤. ì´ê²ƒì„ `ë”ë¸” ë²„í¼ë§ í’€ë§ ê¸°ìˆ `ì´ë¼ê³  ë¶€ë¥¸ë‹¤.

ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ë…¸ë“œë¥¼ í’€ë§í•˜ì—¬ ì¬ì‚¬ìš©í•˜ë©´, ì§€ì—° ìƒì„±í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì—…ë°ì´íŠ¸ ë˜ì§€ ì•ŠëŠ” ë…¸ë“œì— ëŒ€í•œ ì¶”ê°€ ê°ì²´ í• ë‹¹ì„ í”¼í•  ìˆ˜ ìˆê³  í•„ìš”í•œ ê²½ìš° ì¶”ê°€ ë©”ëª¨ë¦¬ë¥¼ íšŒìˆ˜í•  ìˆ˜ ìˆë„ë¡ í•´ì¤€ë‹¤.

(We use a double buffering pooling technique because we know that we'll only ever need at most two versions of a tree. We pool the "other" unused node that we're free to reuse. This is lazily created to avoid allocating extra objects for things that are never updated. It also allow us to reclaim the extra memory if needed.)

### resetWorkInProgress

ì´ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ Fiberê°€ ì²« ë²ˆì§¸ íŒ¨ìŠ¤ ì´ì „ì— createFiber ë˜ëŠ” createWorkInProgressì—ì„œ ì„¤ì •í–ˆë˜ ê°’ìœ¼ë¡œ ì¬ì„¤ì •ëœë‹¤.

ì´ìƒì ìœ¼ë¡œëŠ” í•„ìš”í•˜ì§€ ì•Šì€ í•¨ìˆ˜ì´ì§€ë§Œ, ë¶ˆí–‰í•˜ê²Œë„ ë§ì€ ì½”ë“œëŠ” currentì—ì„œ ì½ê³  workInProgressì—ì„œ ì¨ì•¼í•˜ëŠ” ê²½ìš°ì— workInProgressì—ì„œ ì½ê³  ìˆë‹¤.

(This resets the Fiber to what createFiber or createWorkInProgress would have set the values to before during the first pass. Ideally this wouldn't be necessary but unfortunately many code paths reads from the workInProgress when they should be reading from current and writing to workInProgress.)

### createHostRootFiber

ë£¨íŠ¸ ë…¸ë“œì˜ Fiber ê°ì²´ë¥¼ ë§Œë“œëŠ” í•¨ìˆ˜.

### createFiberFromElement

React elementë¥¼ ë°›ì•„ì„œ ê·¸ì— í•´ë‹¹í•˜ëŠ” Fiber ê°ì²´ë¥¼ ìƒì„±í•œë‹¤.

ì´ì™€ ë¹„ìŠ·í•œ ì—¬ëŸ¬ í•¨ìˆ˜(i.e. createFiberFromFragment)ê°€ ìˆì§€ë§Œ ê·¸ ì—­í• ì€ ì´ê²ƒê³¼ ë¹„ìŠ·í•˜ë¯€ë¡œ ìƒëµí•œë‹¤.
