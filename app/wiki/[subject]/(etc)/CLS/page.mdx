import { CodeSelector } from '@/components/code-selector.tsx'

## 누적 레이아웃 이동(Cumulative Layout Shift, CLS)

시각적 안정성을 측정하는 항목으로, 눈에 보이는 페이지 콘텐츠의 예기치 않은 레이아웃 변화량을 정량화한다.

## 공간 예약

`min-height`를 사용해서 동적으로 생성될 콘텐츠의 높이를 미리 예약하거나, 스켈레톤 UI를 사용한다.

페이지의 뒷 부분에 배치하는 것도 방법이다.

SSR을 사용해서 동적으로 엘리먼트가 삽입되는 것을 최소화 해보는 것도 중요하다.

레이아웃을 변경하지 않고 사용자에게 새로운 콘텐트가 사용 가능하다는 알림을 오버레이 하는 방법도 있다.

- [광고, 삽입, 기타 늦게 로드된 콘텐츠](https://web.dev/articles/optimize-cls?hl=ko#late-loaded-content)

## 폰트

- 폰트가 뒤늦게 적용되는 것을 방지하기 위해 link의 rel=preload 사용하기
- `font-display: optional` 적용하기
- `size-adjust` 적용하기

## 이미지

반응형 웹사이트의 경우 기기의 크기에 따라 이미지의 크기도 변한다.

<CodeSelector names={['css']} desc='ex1' />

```css
img {
  width: 100%;
  height: auto;
}
```

하지만 이렇게 코드를 작성한 경우, CLS가 커지는 결과를 낳는다.

왜냐하면 이미지가 다운로드되기 전까지 높이를 알 수 없기 때문이다.

`aspect-ratio`를 사용하면 레이아웃 변경을 방지할 수 있다.

<CodeSelector names={['css']} desc='ex2' />

```css
img {
  width: 100%;
  aspect-ratio: 8 / 6;
}
```

img의 width와 height에 비율을 명시해도 같은 효과가 나타난다.

```html
<img src="image.jpg" alt="..." width="8" height="6" />
```

```css
img {
  width: 100%;
}
```

- [레이아웃 변경 방지](https://web.dev/articles/aspect-ratio?hl=ko#example_preventing_layout_shift)

## References

- [레이아웃 변경 누적 최적화](https://web.dev/articles/optimize-cls?hl=ko)
