## 모듈러 곱셈 역원

곱셈에서 어떤 정수 $a$의 항등원은 1이고 역원은 $\frac{1}{a}$다.

그런데 $\frac{1}{a}$은 정수가 아니므로 모듈러에서 사용할 수 없다.

대신에, $a \cdot x \equiv 1 \pmod{m}$이 될 때의 $x$를 `a의 m에 대한 모듈러 곱셈 역원`이라고 부른다.

모듈러 곱셈 역원 $x$는 존재하지 않을 수도 있다. (e.g. 2 \* x % 4 = 1이 되는 x는 존재하지 않는다.)

모듈러 곱셈 역원이 존재하는 경우는 $a$와 $m$이 서로소인 경우와 동치다. 따라서 $m$이 소수라면, 모듈러 곱셈 역원은 항상 존재하게 된다.

## 모듈러 곱셈 역원을 구하는 방법

$a \cdot x \equiv 1 \pmod{m}$에서 $ax = km + 1$로 표현할 수 있다.

이를 정리하면, $ax - km = 1$이 되고, $-k$를 $y$로 치환하면 $ax + my = 1$이 된다.

이는 확장 유클리드 알고리즘에서 $\gcd(a,m)=1$인 경우와 같고, $a$의 $m$에 대한 모듈러 곱셈 역원 $x$를 구할 수 있게 된다.

## 모듈러 곱셈 역원과 나눗셈

모듈러 연산에서 아래와 같은 성질은 불가능하다고 알고 있다.

$(a \div b) \bmod m \not\equiv (a \bmod m) \div (b \bmod m) \pmod{m}$

대신에 아래와 같이 곱셈으로 바꿔보자.

$a \cdot b^{-1} \bmod m = (a \bmod m) \times (b^{-1} \bmod m)$

$(b^{-1} \bmod m)$을 어떻게 구할 수 있는지 살펴보자.

$b$의 $m$에 대한 모듈러 곱셈 역원을 $x$라고 하면 $b \cdot x \equiv 1 \pmod{m}$이고, 양변에 $b^{-1}$을 곱하면 $x \equiv b^{-1} \pmod{m}$가 성립한다.

따라서 확장 유클리드 알고리즘으로 $b$의 $m$에 대한 모듈러 곱셈 역원 $x$를 구하고, $x \bmod m$을 구하면 $b^{-1} \bmod m$을 구한 것이다.

만약에 $m$이 소수라면, 페르마의 소정리를 사용하여 $b^{m-2} \equiv b^{-1} \pmod m$으로 바로 구할 수도 있다.

정리해보면

1. $a \div b \equiv a \cdot b^{-1} \equiv (a \bmod m) \times (b^{-1} \bmod m) \pmod{m}$
2. ($b^{-1} \bmod m$)을 구하는 2가지 방법
3. $b$의 $m$에 대한 모듈러 곱셈 역원 $x$에 대해 $x \bmod m$을 구한다. (확장 유클리드 알고리즘 사용)
4. $m$이 소수이면, $b^{m-2} \bmod m$을 구한다. (페르마 소정리, 분할 정복을 이용한 거듭제곱을 사용)
